{% extends "base.html" %}
{% block content %}

<h2 class="text-2xl font-bold text-center mb-6">🏆 Leaderboard</h2>
<style>
    .fade-in {
      animation: fadeIn 2s ease-in-out;
    }
  
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  </style>

{% if qr_image_base64 %}
<div class="text-center mb-6">
    <p class="text-xl font-semibold mb-2">Scan to Join the Game</p>
    <img src="data:image/png;base64,{{ qr_image_base64 }}" alt="Join Game QR Code" class="mx-auto w-48 h-48">
</div>
{% endif %}

<div class="space-y-4 fade-in">
    {% for player in scores %}
    <div class="bg-white shadow-md rounded-xl p-4 flex items-center justify-between border-2 
    {% if loop.index0 == 0 %}
        border-yellow-400
    {% elif loop.index0 == scores|length - 1 %}
        border-red-400
    {% else %}
        border-gray-200
    {% endif %}">

        <div class="flex items-center space-x-4">
            <div class="text-xl font-semibold text-gray-700">
                {{ loop.index }}. {{ player.name }}
                {% if loop.index0 == 0 %}<span class="ml-2">👑</span>{% endif %}
            </div>
        </div>
        <div class="text-right">
            <div class="text-2xl font-bold text-green-700">{{ player.total_score }}</div>
        </div>
    </div>
    {% endfor %}
</div>

<script>
  const socket = new WebSocket(`ws://${window.location.host}/socket/scores`);
  socket.onmessage = (event) => {
      if (event.data === "update") {
          console.log("🔄 Refreshing scoreboard...");
          location.reload();
      }
  };
  </script>

{% endblock %}